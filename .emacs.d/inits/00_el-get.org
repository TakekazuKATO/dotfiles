* El-get
  Emacs 用パッケージマネージャー
  - https://github.com/dimitri/el-get

** 環境による場合分け
   el-get 実行前に, 環境による場合分けのマクロを定義.

#+begin_src emacs-lisp 
;; -----------------------------------------------------------------------
;; Function : 環境による場合分けの方法
;;   http://d.hatena.ne.jp/tomoya/20090811/1250006208
;; ------------------------------------------------------------------------
(defun x->bool (elt) (not (not elt)))

;; emacs-version predicates
(setq emacs22-p (string-match "^22" emacs-version)
      emacs23-p (string-match "^23" emacs-version)
      emacs23.0-p (string-match "^23\.0" emacs-version)
      emacs23.1-p (string-match "^23\.1" emacs-version)
      emacs23.2-p (string-match "^23\.2" emacs-version)
      emacs24.3-p (string-match "^24\.3" emacs-version)
      emacs24.4-p (string-match "^24\.4" emacs-version)
)

;; system-type predicates
(setq darwin-p  (eq system-type 'darwin)
      ns-p      (eq window-system 'ns)
      carbon-p  (eq window-system 'mac)
      linux-p   (eq system-type 'gnu/linux)
      colinux-p (when linux-p
		  (let ((file "/proc/modules"))
		    (and
		     (file-readable-p file)
		     (x->bool
		      (with-temp-buffer
			(insert-file-contents file)
			(goto-char (point-min))
			(re-search-forward "^cofuse\.+" nil t))))))
      cygwin-p  (eq system-type 'cygwin)
      nt-p      (eq system-type 'windows-nt)
      meadow-p  (featurep 'meadow)
      windows-p (or cygwin-p nt-p meadow-p))
#+end_src

** マシンごとの設定
#+begin_src emacs-lisp
(when linux-p
  (setq el-get-emacs "/usr/local/bin/emacs"))

(when windows-p
  ;; 通知は minibuffer のみ
  (setq el-get-notify-type 'message))
#+end_src


* el-get 同期 Package
#+begin_src emacs-lisp 
(defvar my/el-get-packages-all
 '(
    use-package
    ;; window
    popwin
    switch-window
    ace-jump-mode
    ace-jump-buffer
    ace-isearch
    isearch-dabbrev
    open-junk-file
    iy-go-to-char
    key-chord
    jump-char
    ace-jump-zap
    ace-window
    recentf-ext
    ;; text
    yasnippet
    auto-complete
    anzu
    auto-highlight-symbol
    highlight-symbol
    multiple-cursors
    bm
    emacs-async
    pcre2el
    ht
    iedit
    fic-ext-mode
    codic
    google-this
    google-translate
    sdic
    search-web
    wgrep
    phi-search
    ;; smart-compile 独自 age 改造したものを elisp においた
    expand-region
    ;; utility
    ;; howm
    ;; direx
    stripe-buffer
    tempbuf
    exec-path-from-shell
    ;; bitlbee
    migemo
    magit
    ;; minimap
    e2wm
    e2wm-direx
    psession
    elscreen-persist
    revive
    imenu-anywhere
    ;; helm
    helm
    helm-descbinds
    helm-orgcard
    helm-gtags
    helm-migemo
    helm-kaomoji
    helm-wl-address
    helm-google
    helm-etags-plus
    helm-swoop
    helm-c-yasnippet
    org-mode
    org-pandoc
    deferred
    ;; color
    color-theme
    molokai-theme
    rainbow-delimiters
    ;; programming
    flymake
    flycheck
    flycheck-color-mode-line
    quickrun
    php-mode
    ;; tdd
    projectile
    ;; ruby
    ruby-block
    robe-mode
    ruby-electric
    rspec-mode
    ruby-refactor
    rcodetools
    inf-ruby
    auto-complete-ruby
    ;; python
    python-mode
    ;; java
    auto-java-complete
    log4j-mode
    ;; jtags-mode
    ant
    ;; haskell-mode ??
    ;; ac-haskell-process
    ;; anything-rdefs
    rainbow-mode
    yaml-mode
    markdown-mode
    plantuml-mode
    conkeror-minor-mode
    elscreen
    elscreen-wl
    ;; tomatinho
    wanderlust
    twittering-mode
    erc-hl-nicks
    erc-nick-notify
    ;; for linux
    migemo
    magit
    undo-tree
    ;; pomodoro
    joseph-single-dired
    ;; others
    ;; key-guide
    ag
    gtags
    guide-key
    mmm-mode
    auto-capitalize
    calfw
    helm-github-issues
    helm-open-github
    helm-ag
    org2blog
    org-gcal
    ox-rst
    ox-wk
    gist
    cool-mode
    esup
    initchart
    scala-mode2
    ensime
    sbt-mode
    eclim
    smartrep
    ac-helm
    elscreen-interchange
    clocktable-by-tag
    helm-flyspell-collect
    cde
    eww-lnum
    ghc-mod
    hl-anything
    ace-link
    ddskk
    ac-skk
    ac-ja
    scheme-complete
    eldoc-extension
    smartparens
    ess-R-data-view
    ess-R-object-popup
    ctable
    helm-R
    ;; ansible
    lispxmp
    vlfi
    emacs-refactor
    keisen-ext
    )
 "A list of packages to install from el-get at launch.")

(defvar my/el-get-packages-windows
  '(vbasense
    visual-basic-mode
    )
  "A list of packages to install from el-get at launch for windows")

(defvar my/el-get-packages-linux
  '(
    pdf-tools
    flyspell
;;    yspel
    )
  "A list of packages to install from el-get at launch for linux")

;; 同期する
;; -> use-packageで遅延評価するために場所を移動.

;; (el-get 'sync my/el-get-packages-all)
;; (when windows-p
;;   (el-get 'sync my/el-get-packages-windows))
;; (when linux-p
;;   (el-get 'sync my/el-get-packages-linux))

;; まちがって repo 配下の elc も消しちゃったらこれを有効にしとて byte compile
;; Whether or not to byte-compile packages at init
;; (setq el-get-byte-compile-at-init t)
#+end_src

* Tips
** el-get-is-lazy
   パッケージが存在しないときは, el-get で取得する.

   追加しわすれに気づけないので, コメントアウト.

#+begin_src emacs-lisp
;; (setq el-get-is-lazy t)
#+end_src

** Windows
   - [[https://github.com/dimitri/el-get/wiki/Installation-on-Windows][Installation on Windows · dimitri/el-get Wiki]]
   - [[http://stackoverflow.com/questions/17219643/cant-install-emacs-el-get-package-emacs-cant-connect-to-the-internet][windows - can't install emacs el-get package, emacs can't connect to the internet - Stack Overflow]]
   - [[https://github.com/Bruce-Connor/paradox/issues/5][fails without GnuTLS · Issue #5 · Bruce-Connor/paradox]]

   gist にアクセスできない...

   Linux だと, gnutls-bin をいれる.

 #+begin_src text
Contacting host: api.github.com:443
Opening TLS connection to `api.github.com'...
Opening TLS connection with `gnutls-cli --insecure -p 443 api.github.com'...failed
Opening TLS connection with `gnutls-cli --insecure -p 443 api.github.com --protocols ssl3'...failed
Opening TLS connection with `openssl s_client -connect api.github.com:443 -no_ssl2 -ign_eof'...failed
Opening TLS connection to `api.github.com'...failed
 #+end_src

** el-get-elpa
   MELPA との連携. M-x el-get-elpa-build-local-recipes する.
   - http://stackoverflow.com/questions/23165158/how-do-i-install-melpa-packages-via-el-get

 #+begin_src emacs-lisp 
;; (require 'el-get-elpa)
;; (unless (file-directory-p el-get-recipe-path-elpa)
;;   (el-get-elpa-build-local-recipes))
 #+end_src

